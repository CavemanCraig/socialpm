<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:ocp="http://java.sun.com/jsf/composite/ocpcommon"
	xmlns:pretty="http://ocpsoft.com/prettyfaces"
	xmlns:socialpm="http://java.sun.com/jsf/composite/socialpm"
	xmlns:a="http://java.sun.com/jsf/composite/ajax">

<ui:composition template="/WEB-INF/view/templates/socialpm.xhtml">

	<ui:param name="title"
		value="#{currentProjectBean.project.name} &#187; Iterations" />

	<ui:define name="header">
		<h2> &#187; Iterations </h2>
	</ui:define>

	<ui:define name="side-items">
		<li>
			<h3>New Iteration</h3>
			<div>
				<h:form id="additeration">
					<f:validateBean>
						<ocp:formFix />
						<label for="title"> <h:outputText value="Title: " /> <ocp:message
							for="additeration:title" /> <br />
						</label>
						<h:inputText id="title" value="#{manageIterationsBean.newIteration.title}"
							required="true" />
						<br />
						<br />
						<label for="startdate">
						<h:outputText
							value="Start Date (mm/dd/yyyy):" /></label>
							<ocp:datepicker id="startdate" todayOrFuture="true"
							value="#{manageIterationsBean.newIteration.startDate}" required="true">
							</ocp:datepicker>
						<br />
						<br />
						
						<label for="enddate"> 
						<h:outputText
							value="End Date (mm/dd/yyyy):" /></label>
						<ocp:datepicker id="enddate" padMidnight="true"
							value="#{manageIterationsBean.newIteration.endDate}" required="true" />
						<br />
						
						<ocp:separator />
						<h:commandButton action="#{manageIterationsBean.create}"
							value="Add" />
					</f:validateBean>
				</h:form>
			</div>
		</li>
	</ui:define>

	<ui:define name="content">
		<h:form id="manageIterations">
			<h:dataTable id="iterations" var="iteration" width="100%"
				value="#{manageIterationsBean.iterations}" styleClass="tbl"
				rowClasses="odd, even">
				<h:column>
					<f:facet name="header">
						<h:outputText value="No#" />
					</f:facet>
					<h:outputText value="#{iteration.number}" />
				</h:column>
				<h:column>
					<f:facet name="header">
						<h:outputText value="Title" />
					</f:facet>
					<pretty:link mappingId="#{urlConstants.VIEW_ITERATION}"
						styleClass="block p5 box-bordered" 
						style="color: #333; background-color: #FFFFaa;">
						<f:param value="#{currentProjectBean.project.canonicalName}" />
						<f:param value="#{iteration.title}" />
						<h:outputText value="#{iteration.title}" />
					</pretty:link>
				</h:column>
				<h:column>
					<f:facet name="header">
						<h:outputText value="Start Date" />
					</f:facet>
					<h:outputText value="#{iteration.startDate}" >
						<f:convertDateTime style="short" />
					</h:outputText>&nbsp;
				</h:column>
				<h:column>
					<f:facet name="header">
						<h:outputText value="End Date" />
					</f:facet>
					<h:outputText value="#{iteration.endDate}" >
						<f:convertDateTime style="short" />
					</h:outputText>&nbsp;
				</h:column>
				<h:column>
					<f:facet name="header">
						<h:outputText value="Actions" />
					</f:facet>
					<h:commandLink action="#{manageIterationsBean.remove(iteration)}"
						value="delete"
						styleClass="block p5 box-bordered" 
						style="color: #333; background-color: #FFFFcc;"
						onclick="return confirm('Really delete iteration #{iteration.title}?');"
						rendered="#{!iteration.default and !iteration.ended}">
						<f:param name="iteration" value="#{iteration.id}" />
					</h:commandLink>
					<h:panelGroup rendered="#{iteration.default}">
						&nbsp;
					</h:panelGroup>
					<h:panelGroup styleClass="faded" rendered="#{iteration.ended}">
						Ended: <h:outputText value="#{iteration.endDate}">
							<f:converter converterId="prettyTimeConverter"/>
						</h:outputText>
					</h:panelGroup>
				</h:column>
			</h:dataTable>
		</h:form>
	</ui:define>
</ui:composition>
</html>