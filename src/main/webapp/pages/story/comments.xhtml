<!DOCTYPE html
      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ocp="http://java.sun.com/jsf/composite/ocpcommon"
	xmlns:spm="http://java.sun.com/jsf/composite/socialpm"
	xmlns:pretty="http://ocpsoft.com/prettyfaces"
	xmlns:tmpl="http://java.sun.com/jsf/composite/ocpsoft-jsf2-templates/liquid-blue-2col"
	xmlns:ui="http://java.sun.com/jsf/facelets" xml:lang="en" lang="en">

<ui:composition>
<h:form id="commentsform">
	<ui:repeat var="c" value="#{currentStoryBean.story.comments}">
		<spm:comment comment="#{c}" story="#{currentStoryBean.story}" />
	</ui:repeat>
	
	<h:panelGroup rendered="#{authorizationBean.isMember == true}">
		<f:validateBean>
			<div class="m5t w67 center">
				<label for="commentInput">Add a comment: <ocp:message
					id="inputError" for="commentInput" /> </label> <h:outputText
					styleClass="note"
					value="-- No HTML or other funny business, please..." /> <br />
				<h:inputTextarea id="commentInput"
					value="#{viewStoryBean.comment.text}" cols="55" rows="3" tabindex="14">
					<f:validateBean />
				</h:inputTextarea>
				<br/>
				
				<h:commandButton id="add" value="Add Comment" tabindex="15"
					action="#{storyController.addComment(viewStoryBean.comment)}" >
					<f:ajax execute="@this commentInput" render="@form" />
				</h:commandButton>
			</div>
		</f:validateBean>
	</h:panelGroup>
</h:form>

</ui:composition>
</html>