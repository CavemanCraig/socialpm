<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:ocp="http://java.sun.com/jsf/composite/ocpcommon"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a="http://java.sun.com/jsf/composite/ajax"
	xmlns:pretty="http://ocpsoft.com/prettyfaces"
	xmlns:socialpm="http://java.sun.com/jsf/composite/socialpm">

<ui:composition template="/WEB-INF/view/templates/socialpm.xhtml">
	<ui:param name="title"
		value="#{viewStoryBean.story.project.name}: Story #{viewStoryBean.story.number}" />

	<ui:define name="header">
		<h2>
			<h:outputText value=" &#171; " />
			<pretty:link mappingId="#{urlConstants.VIEW_STORY}">
				<f:param value="#{viewStoryBean.story.project.name}" />
				<f:param value="#{viewStoryBean.story.number}" />
				<h:outputText value="Story #{viewStoryBean.story.number}" />
			</pretty:link>
			<h:outputText value=" &#171; History" />
		</h2>
		<ul><li>
			<pretty:link mappingId="#{urlConstants.VIEW_STORY}">
				<f:param value="#{viewStoryBean.story.project.name}" />
				<f:param value="#{viewStoryBean.story.number}" />
				<h:outputText value="&#171; " />
				<h:outputText value="Back to Story #{viewStoryBean.story.number}" />
			</pretty:link>
		</li></ul>
	</ui:define>


	<ui:define name="side-items">
		<ui:include src="storyStats.xhtml" />
	</ui:define>

	<ui:define name="content">
		<ui:include src="storyDetails.xhtml" />

		<h2>History:</h2>
		<h:dataTable style="margin: 3px;" id="tTable" styleClass="tbl"
			value="${viewStoryBean.story.history}" rowClasses="odd,even"
			var="event" width="100%">

			<h:column>
				<f:facet name="header">
					<h:outputText value="Occurred:" />
				</f:facet>
				<f:facet name="footer">
				</f:facet>
				<h:outputText value="${event.createdOn}">
					<f:converter converterId="prettyTimeConverter" />
				</h:outputText>
			</h:column>

			<h:column>
				<f:facet name="header">
					<h:outputText value="Event:" />
				</f:facet>
				<f:facet name="footer">
				</f:facet>
				<h:outputText value="${event.class.simpleName}" />
			</h:column>

			<h:column>
				<f:facet name="header">
					<h:outputText value="From:" />
				</f:facet>
				<f:facet name="footer">
				</f:facet>
				<h:outputText rendered="${event.oldValue == null}">
					<h:outputText value="---" />
				</h:outputText>
				<h:outputText rendered="${event.oldValue != null}">
					<h:outputText value="${event.oldValue}" />
				</h:outputText>
			</h:column>

			<h:column>
				<f:facet name="header">
					<h:outputText value="To:" />
				</f:facet>
				<f:facet name="footer">
				</f:facet>
				<h:outputText rendered="${event.newValue == null}">
					<h:outputText value="---" />
				</h:outputText>
				<h:outputText rendered="${event.newValue != null}">
					<h:outputText value="${event.newValue}" />
				</h:outputText>
			</h:column>

			<h:column>
				<f:facet name="header">
					<h:outputText value="By:" />
				</f:facet>
				<f:facet name="footer">
				</f:facet>
				<pretty:link mappingId="#{urlConstants.USER_PROFILE}">
					<f:param value="${event.actor}" />
					<h:outputText value="${event.actor}" />
				</pretty:link>
			</h:column>
		</h:dataTable>
	</ui:define>
</ui:composition>
</html>